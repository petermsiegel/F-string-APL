<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>∆F_Help</title>
	<style>
		/* Basic styles for readability */
		body {
			font-family: sans-serif;
			max-width: 800px;
			margin: 2em auto;
			padding: 0 1em;
			line-height: 1.6;
		}
		img { max-width: 100%; height: auto; }
		pre { background-color: #f4f4f4; padding: 1em; overflow-x: auto; }
		code { font-family: monospace; }
	</style>
</head>
<body>
	<!--
Preview side-by-side: cmd-K, V,
md->HTML: opt-shift-M
Update APL ∆F_Help.html: ⎕SH 'cp index.html ∆F_Help.html' ◇ ∆F⍨'help'
-->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/5.8.1/github-markdown.css">
<!-- . Style stuff related to APL and my random preferences... -->
<style> 
  p {
    font-family: Georgia;
    
    line-height: 1.2;
  }
  li {
  }
  /* Inline code */
  code { 
    
    background-color: #ddfafaff;
    padding: 2px 4px;
    border-radius: 3px;
    font-family: "APL386 Unicode", APL386, "APL385 Unicode", APL385,
       "Courier New", Courier, Lucida Console", "Consolas", monospace;
  }
  /* Code blocks */ 
  pre { 
    background-color: #ddfafaff;  
    color: #0a0a0aff; 
    
    line-height: 105%;
    padding: 15px;
    border-radius: 5px;
    overflow-x: auto; 
    font-family: "APL386 Unicode", APL386, "APL385 Unicode", APL385, 
        "Courier New", Courier, "Lucida Console", "Consolas", monospace;
  }
  table {
    background-color: #eae9ebaa;
    line-height: 1.1;
    vertical-align: top;
    font-family: "APL386 Unicode", APL386, "APL385 Unicode", APL385 "Courier New", Courier,
    "Lucida Console", "Consolas", monospace;
  }
  /* Table header */
  th {  
    line-height: 1.1;
    vertical-align: top;
    font-weight: 900;
    background-color: #740000ff;
    color: #f3efef;
  }
  td {
    vertical-align: top;
  }
  blockquote {
    
    background-color: #f4f5f5ff;  
  }
  .content-with-bar {
    border-left: 2px solid #ea2f0eff; /* Adjust color and thickness as needed */
    padding-left: 15px; /* Space between the bar and content */
    margin-left: 0px; /* Optional: Space from the left edge of the page */
    height: auto; /* Or set a fixed height, e.g., 200px */
    overflow: hidden; /* Clear floats if internal content uses them */
  }
</style>
<h2>∆F — Formatted String Literals</h2>
<h3>∆F In Brief</h3>
<blockquote>
<center><p style="padding-left: 15px;padding-right: 5px;padding-top: 5px;padding-bottom: 5px;color: white; background-color: #4f62f0ff;"><b>∆F</b> is a function for Dyalog APL that interprets <i>&ThinSpace;f-strings</i>, a concise, yet powerful way to display multiline Unicode text and complex, often multidimensional expressions in an APL-friendly style.¹<br><span style="color: pink;margin-top: 10px;display: block;">Inspired by Python's <i>&ThinSpace;f-strings</i>,² &ensp;but designed for APL.&nbsp;</span></p></center>
</blockquote>
<hr>
<ul>
<!-- TOC Link Suppressed -->
</ul>
<p><strong>∆F</strong> <em>f-strings</em> can concisely include:</p>
<ul>
<li>
<p><strong>Text fields</strong>, expressions that can generate multiline Unicode text, using the sequence <code>`◇</code> (<strong>backtick</strong> + <strong>statement separator</strong>³) to generate a newline (<small><strong>⎕UCS 13</strong></small>);</p>
</li>
<li>
<p><strong>Code fields</strong>, allowing users to evaluate and display APL arrays in the user environment, arrays passed as <strong>∆F</strong> arguments, as well as arbitrary APL expressions based on full multi-statement⁴ dfn logic; each <strong>Code field</strong> must return a value, simple or otherwise, which will be catenated with other fields and returned from <strong>∆F</strong>;</p>
<p><strong>Code fields</strong> also provide a number of concise, convenient extensions, such as:</p>
<ul>
<li>
<p><strong>Quoted strings</strong> in <strong>Code fields</strong>, with several quote styles:</p>
<ul>
<li><strong>double-quotes</strong> <code>{&quot;like this&quot;}</code> or this <code> {&quot;on`◇&quot;&quot;three&quot;&quot;`◇lines&quot;}</code>,</li>
<li><strong>single-quotes</strong>, <em>distractingly</em> <code>{''shown ''''right'''' here''}'</code>, <em>or even</em></li>
<li><strong>double angle quotation marks</strong>,⁵ i.e. <em>guillemets</em>,<br>
<code>{«with internal quotes like &quot;this&quot; or ''this''.»}</code>;</li>
</ul>
</li>
<li>
<p>Simple shortcuts⁶ for</p>
<ul>
<li><strong>format</strong>ting numeric arrays, <strong>$</strong> (short for <strong>⎕FMT</strong>): <code>{&quot;F7.5&quot; $ ?0 0}</code>,</li>
<li>putting a <strong>box</strong> around a specific expression, <strong>`B</strong>: <code>{`B ⍳2 2}</code>,</li>
<li>placing the output of one expression <strong>above</strong> another, <strong>%</strong>: <code>{&quot;Pi&quot;% ○1}</code>,</li>
<li>formatting <strong>date</strong> and <strong>time</strong> expressions from APL timestamps (<strong>⎕TS</strong>) using <strong>`T</strong> ( short for an expression with <strong>1200⌶</strong> and <strong>⎕DT</strong>): <code>{&quot;hh:mm:ss&quot; `T ⎕TS}</code></li>
<li><em>and more</em>;</li>
</ul>
</li>
<li>
<p>Simple mechanisms for concisely formatting and displaying data from</p>
<ul>
<li>user arrays or arbitrary code: <br><code>{tempC}</code> or <code>{tempC&lt;100: 32+tempC×9÷5 ◇ &quot;Too hot&quot;}</code>,
<br></li>
<li>arguments to <strong>∆F</strong> that follow the format string: <code>{32+`⍵1×9÷5}</code>, where <code>`⍵1</code> is a shortcut for <code>(⍵⊃⍨1+⎕IO)</code>;</li>
<li><em>and more</em>;</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Space fields</strong>, providing a simple mechanism both for separating adjacent <strong>Text fields</strong> and inserting (rectangular) blocks of any number of spaces between any two fields, where needed;</p>
<ul>
<li>one space: <code>{ }</code>; five spaces: <code>{     }</code>; or even, zero spaces: <code>{}</code>;</li>
<li>1000 spaces? Use a code field instead: <code>{1000⍴&quot;&quot;}</code>.</li>
</ul>
</li>
<li>
<p>Multiline (matrix) output built up field-by-field, left-to-right, from values and expressions in the calling environment or arguments to <strong>∆F</strong>;</p>
<ul>
<li>After all fields are generated, they are concatenated (after appropriate vertical conformation) to form a single character matrix: <em><strong>the return value from</strong></em> <strong>∆F</strong>. (See the examples below).</li>
</ul>
</li>
</ul>
<p><strong>∆F</strong> is designed⁷ for ease of use, <em>ad hoc</em> debugging, fine-grained formatting and informal user interaction, built using APL’s own powerful functions and operators.</p>
<div style="margin-left: 20px;">
<table>
<thead>
<tr>
<th style="text-align:left">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">¹ Throughout this documentation, notably in the many examples, an index origin of zero (<code>⎕IO=0</code>) is assumed. <strong>Code fields</strong> inherit the index origin and other system variables from the environment (i.e. namespace) in which <strong>∆F</strong> is called; they can be set locally in the code field, as well: <code>∆F '{ ⎕IO←1 ◇ ⎕A ⍳ &quot;APL&quot; }'</code> .</td>
</tr>
<tr>
<td style="text-align:left">² <strong>∆F</strong> is inspired by Python <em><a href="https://docs.python.org/3/tutorial/inputoutput.html#formatted-string-literals">f-strings</a></em>, short for “<strong>formatted string literals</strong>”, but designed for APL’s multi-dimensional worldview. <strong>∆F</strong> <em>f-strings</em> and Python’s are not compatible.</td>
</tr>
<tr>
<td style="text-align:left">³ In this document, we use the symbol <code>◇</code> (<code>⎕UCS 9671</code>) to represent the APL <em>statement separator</em> (<code>⎕UCS 8900</code>), since the latter is displayed <em>in some browsers</em> as a hard-to-read glyph. <strong>∆F</strong> will recognize <code>`◇</code> with <em>either</em> glyph.</td>
</tr>
<tr>
<td style="text-align:left">⁴ <strong>∆F Code fields</strong> <em>as input</em> are limited to a single, possibly very long, line.</td>
</tr>
<tr>
<td style="text-align:left">⁵ <strong>Double angle quotation marks</strong> <big><strong>« »</strong></big> (<em>guillemets</em>) are Unicode chars <code>⎕UCS 171 187</code> (on the std Mac keyboard: <em><em>option-backslash</em></em> and <em><em>option-shift-backslash</em></em>). When including literal guillemets in guillemet-bracketed quotations (<span style="color: red;"><em>but why?</em></span> ), opening guillemets <big><strong>«</strong></big> are <em>not</em> doubled, but <em>two</em> closing guillemets are needed for each literal <big><strong>»</strong></big> required.</td>
</tr>
<tr>
<td style="text-align:left">⁶ Details on all the shortcuts are provided later in this document. See <strong><em>Code Field Shortcuts.</em></strong></td>
</tr>
<tr>
<td style="text-align:left">⁷ As a prototype, <strong>∆F</strong> is relatively slow, using an APL recursive scan to analyze the <strong>f-string</strong>.</td>
</tr>
</tbody>
</table>
</div>
<hr>
<h2>∆F <strong>Help</strong> Information</h2>
<blockquote>
<p>To display this <strong>HELP</strong> information, type: <code>∆F⍨ 'help'</code>.</p>
</blockquote>
<h2>Installing <strong>∆F</strong></h2>
<ol>
<li>
<p>On Github, search for <code>&quot;F-string-APL&quot;</code>.</p>
</li>
<li>
<p>Copy the files <strong>∆Fapl.dyalog</strong> and <strong>∆F_Help.html</strong> into your current working directory (the one shown via <code>]cd</code>).</p>
</li>
<li>
<p>Then, from your Dyalog session (typically <code>#</code> or <code>⎕SE</code>), enter:</p>
<p><code>]load ∆Fapl [-target=</code><strong><em>myns</em></strong><code>]</code></p>
<p>Each time it is called, the <code>]load</code> will create both function <strong>∆F</strong> and namespace <strong>⍙Fapl</strong> in the active namespace (or <strong><em>myns</em></strong>). <strong>⍙Fapl</strong> contains utilities used by <strong>∆F</strong>. If  <strong>∆F_Help.html</strong> is available at <code>]load</code> time, it will be copied into <strong>⍙Fapl</strong> (or a message will note its absence).</p>
</li>
</ol>
<blockquote>
<p>Now, <strong>∆F</strong> is available in the active namespace (or <strong><em>myns</em></strong>), along with <strong>⍙Fapl</strong>.</p>
</blockquote>
<hr>
<h2>∆F EXAMPLES</h2>
<p>Before providing information on <strong>∆F</strong> syntax and other details, <em>let’s start with some examples</em>…</p>
<p>First, let’s set some context.</p>
<pre><code>   ⎕IO ⎕ML← 0 1        
</code></pre>
<h3>Code Fields</h3>
<p>Here are <strong>Code fields</strong> with simple variables.</p>
<pre><code>   name← 'Fred' ◇ age← 43
   ∆F 'The patient''s name is {name}. {name} is {age} years old.'
The patient's name is Fred. Fred is 43 years old.
</code></pre>
<p><strong>Code fields</strong> can contain arbitrary expressions. With default options, <strong>∆F</strong> always
returns a single character matrix.
Here <strong>∆F</strong> returns a matrix with 2 rows and 32 columns.</p>
<pre><code>   tempC← ⍪35 85
   ⍴⎕← ∆F 'The temperature is {tempC}{2 2⍴&quot;°C&quot;} or {32+tempC×9÷5}{2 2⍴&quot;°F&quot;}'
The temperature is 35°C or  95°F.
                   85°C    185°F
2 32                
</code></pre>
<p>Here, we assign the <em>f-string</em> to an APL variable, then call <strong>∆F</strong> twice!</p>
<pre><code>   ⎕RL← 2342342                 ⍝ ⎕RL: Ensure our random #s aren't random!
   names← 'Mary' 'Jack' 'Tony' ◇ prize← 1000
   f← 'Customer {names⊃⍨ ?≢names} wins £{?prize}!'
   ∆F f
Customer Jack wins £80!
   ∆F f
Customer Jack wins £230!
</code></pre>
<p>Isn’t Jack lucky, winning twice in a row!</p>
<h3>Text Fields and Space Fields</h3>
<p>Below, we have some multi-line <strong>Text fields</strong> separated by non-null <strong>Space fields</strong>.</p>
<ul>
<li>The backtick is our “escape” character.</li>
<li>The sequence `◇ generates a new line in the current text field.</li>
<li>Each <strong>Space field</strong> <code>{ }</code> in the next example contains one space within its braces. It produces a matrix a <em>single</em> space wide with as many rows as required to catenate it with adjacent fields.</li>
</ul>
<p>A <strong>Space field</strong> is useful here because each multi-line field is built
in its own rectangular space.</p>
<pre><code>   ∆F 'This`◇is`◇an`◇example{ }Of`◇multi-line{ }Text`◇Fields'
This    Of         Text
is      multi-line Fields
an
example
</code></pre>
<h3>Null Space Fields</h3>
<p>Two adjacent <strong>Text fields</strong> can be separated by a Null <strong>Space field</strong> <code>{}</code>,
for example when at least one field contains multiline input that you
want formatted separately from others, keeping each field in is own rectangular space:</p>
<pre><code>⍝  Extra space here ↓ 
   ∆F 'Cat`◇Elephant `◇Mouse{}Felix`◇Dumbo`◇Mickey'
Cat      Felix
Elephant Dumbo
Mouse    Mickey
</code></pre>
<p>In the above example, we added an extra space after the longest
animal name, <em>Elephant</em>, so it wouldn’t run into the next word, <em>Dumbo</em>.</p>
<p><strong>But wait! There’s an easier way!</strong></p>
<p>Here, you surely want the lefthand field to be guaranteed to have a space
after <em>each</em> word without fiddling; a <strong>Space field</strong> with at least
one space will solve the problem:</p>
<pre><code class="language-apl">⍝                          ↓↓↓
   ∆F 'Cat`◇Elephant`◇Mouse{ }Felix`◇Dumbo`◇Mickey'
Cat      Felix
Elephant Dumbo
Mouse    Mickey
</code></pre>
<h3>Code Fields (Continued)</h3>
<p>And this is the same example, but with two <strong>Code fields</strong> separated
by a <strong>Text field</strong> with a single space. (We could have used a <strong>Space field</strong> <code>{ }</code> here as well.)</p>
<pre><code>   ∆F '{↑&quot;Cat&quot; &quot;Elephant&quot; &quot;Mouse&quot;} {↑&quot;Felix&quot; &quot;Dumbo&quot; &quot;Mickey&quot;}'
Cat      Felix
Elephant Dumbo
Mouse    Mickey
</code></pre>
<p>Here’s a similar example with double quote-delimited strings in <strong>Code fields</strong> with
the newline sequence, <code>`◇</code>:</p>
<pre><code>   ∆F '{&quot;This`◇is`◇an`◇example&quot;} {&quot;Of`◇Multi-line&quot;} {&quot;Strings`◇in`◇Code`◇Fields&quot;}'
This    Of         Strings
is      Multi-line in
an                 Code
example            Fields
</code></pre>
<p>Here is some multiline data we’ll add to our <strong>Code fields</strong>, using APL <em>mix</em> <code>↑</code> to generate multiline objects (matrices).</p>
<pre><code>   fNm←  'John' 'Mary' 'Ted'
   lNm←  'Smith' 'Jones' 'Templeton'
   addr← '24 Mulberry Ln' '22 Smith St' '12 High St'
   ∆F '{↑fNm} {↑lNm} {↑addr}'
John Smith     24 Mulberry Ln
Mary Jones     22 Smith St
Ted  Templeton 12 High St
</code></pre>
<p>Here’s a slightly more interesting code expression, using the shortcut <code>$</code> (<code>⎕FMT</code>)
to round Centrigade numbers to the nearest whole degree and Fahrenheit numbers to the nearest tenth of a degree.
(We could have used <code>0⍕⍪</code> and <code>1⍕⍪</code>, of course.)</p>
<pre><code>   C← 11.3 29.55 59.99
   ∆F 'The temperature is {&quot;I2&quot; $ C}°C or {&quot;F5.1&quot;$ 32+9×C÷5}°F'
The temperature is 11°C or  52.3°F
                   30       85.2
                   60      140.0
</code></pre>
<h3>The Box Shortcut</h3>
<p>Here we place boxes around key <strong>Code fields</strong> in this same example to introduce the shortcut <code>`B</code> (Box).</p>
<pre><code>   C← 11.3 29.55 59.99
   ∆F '`◇The temperature is {`B &quot;I2&quot; $ C}`◇°C or {`B &quot;F5.1&quot; $ 32+9×C÷5}`◇°F'
                   ┌──┐      ┌─────┐
The temperature is │11│°C or │ 52.3│°F
                   │30│      │ 85.2│
                   │60│      │140.0│
                   └──┘      └─────┘
</code></pre>
<h3>Box Mode</h3>
<p>What if you want to place a box around every <strong>Code</strong>, <strong>Text</strong>, <strong><em>and</em></strong> <strong>Space field</strong>?
We can just use the <strong>Box</strong> mode option!</p>
<p>While we can’t place boxes around text (or space) fields using <code>`B</code>,
we can place a box around <em><strong>each</strong></em> field <em>regardless</em> of type. by setting <strong>Box</strong> mode (<strong>∆F</strong>’s
third option) to <code>1</code>, <em>e.g.</em> setting <strong>∆F</strong>’s left argument to <code>0 0 1</code>:</p>
<pre><code>   C← 11.3 29.55 59.99
⍝      ↓¯¯¯ Box mode
   0 0 1 ∆F '`◇The temperature is {&quot;I2&quot; $ C}`◇°C or {&quot;F5.1&quot; $ 32+9×C÷5}`◇°F'
┌───────────────────┬──┬──────┬─────┬──┐
│                   │11│      │ 52.3│  │
│The temperature is │30│°C or │ 85.2│°F│
│                   │60│      │140.0│  │
└───────────────────┴──┴──────┴─────┴──┘
</code></pre>
<p>We said you could place a box around every field, but there’s an exception.
<strong>Null Space fields</strong> <code>{}</code>, i.e. 0-width <strong>Space fields</strong>, are discarded once they’ve done their work of separating adjacent fields (typically <strong>Text fields</strong>), so they won’t be placed in boxes. Try this expression on your own:</p>
<pre><code>   0 0 1 ∆F 'abc{}def{}{}ghi{&quot;&quot;}jkl{ }mno'
</code></pre>
<p>In contrast, <strong>Code fields</strong> that return null values (like <code>{&quot;&quot;}</code> above) <em>will</em> be displayed!</p>
<h3>Omega Shortcuts (Explicit)</h3>
<blockquote>
<p>Referencing <strong>∆F</strong> arguments after the <em>f-string</em>: Omega shortcut expressions like <code>`⍵1</code>.</p>
</blockquote>
<p>The expression <code>`⍵1</code> is equivalent to <code>(⍵⊃⍨ 1+⎕IO)</code>, selecting the first argument after the <em>f-string</em>. Similarly, <code>`⍵99</code> would select <code>(⍵⊃⍨99+⎕IO)</code>.</p>
<p>We will use <code>`⍵1</code> here, both with shortcuts and an externally defined
function <code>C2F</code>, that converts Centigrade to Fahrenheit.
A bit further below, we discuss bare <code>`⍵</code>
(i.e. without an appended non-negative integer).</p>
<pre><code>   C2F← 32+9×÷∘5
   ∆F 'The temperature is {&quot;I2&quot; $ `⍵1}°C or {&quot;F5.1&quot; $ C2F `⍵1}°F' (11 15 20)
The temperature is 11°C or 51.8°F
                   15      59.0
                   20      68.0
</code></pre>
<h3>Referencing the F-string Itself</h3>
<p>The expression <code>`⍵0</code> refers to the <em>f-string</em> itself.¹ Try this yourself:²</p>
<pre><code>   ∆F 'Our string {`⍵0↓} is {≢`⍵0} characters'
</code></pre>
<div style="margin-left: 20px;">
<table>
<thead>
<tr>
<th style="text-align:left">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">¹ <code>`⍵0</code> refers to the <em>f-string</em>, independent of whether there are additional elements in the right argument to <strong>∆F</strong>.</td>
</tr>
<tr>
<td style="text-align:left">² We explain the <code>↓</code> before the closing brace <code>}</code> under <strong><em>Self-Documenting Code Fields</em></strong> below.</td>
</tr>
</tbody>
</table>
</div>
<h3>The Format Shortcut</h3>
<blockquote>
<p>Let’s add commas to some very large numbers using the <code>$</code> (<code>⎕FMT</code>) shortcut.</p>
</blockquote>
<p>We can use Dyalog’s built-in formatting specifier “C” with shortcut <code>$</code> (<code>⎕FMT</code>)
to add appropriate commas to the temperatures!</p>
<pre><code>⍝  The temperature of the sun at its core in degrees C.
   sun_core← 15E6                   ⍝ 15000000 is a bit hard to parse!
   **∆F** 'The sun''s core is at {&quot;CI10&quot; $ sun_core}°C or {&quot;CI10&quot; $ C2F sun_core}°F'
The sun's core is at 15,000,000°C or 27,000,032°F
</code></pre>
<h3>The Shortcut for Numeric Commas</h3>
<p>The <code>`C</code> shortcut adds commas every 3 digits (from the right) to one or more numbers or numeric strings.¹ It has an advantage over the <code>$</code> (Dyalog’s <code>⎕FMT</code>) specifier: it doesn’t require you to guesstimate field widths.</p>
<div style="margin-left: 20px;">
<table>
<thead>
<tr>
<th style="text-align:left">Note</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">¹ Typically, each number or numeric string presented to <code>`C</code> will represent an integer, but if a real number is presented, only the integer part will have commas added.</td>
</tr>
</tbody>
</table>
</div>
<p>Let’s use the <code>`C</code> shortcut to add the commas to the temperatures!</p>
<pre><code>   sun_core← 15E6               ⍝ 15000000 is a bit hard to parse!
   **∆F** 'The sun''s core is at {`C sun_core}°C or {`C C2F sun_core}°F.'
The sun's core is at 15,000,000°C or 27,000,032°F.
</code></pre>
<p>Cool! OK, not literally.</p>
<p>And for a bit of a twist, let’s display either degrees Centrigrade
or Fahrenheit under user control (<code>1</code> =&gt; F, <code>0</code> =&gt; C). Here, we establish
the format-string <code>sunFC</code> first, then pass it to <strong>∆F</strong> with an additional argument.</p>
<pre><code>   sunFC← 'The sun''s core is at {`C C2F⍣`⍵1⊢ sun_core}°{ `⍵1⊃ &quot;CF&quot;}.'
   ∆F sunFC 1
The sun's core is at 27,000,032°F.
   ∆F sunFC 0
The sun's core is at 15,000,000°C.
</code></pre>
<h3>The Quote Shortcut</h3>
<blockquote>
<p>Placing quotes around string elements of an array.</p>
</blockquote>
<p>The <strong>Quote</strong> shortcut <code>`Q</code> recursively scans its right argument, looking for character
scalars, vectors, and rows of character arrays, doubling internal single quotes and
placing single quotes around each such element. Non-character data is returned as is. This is useful, for example, when you wish to clearly distinguish character from numeric data.</p>
<p>Let’s look at a couple of simple examples:</p>
<p>First, let’s use the <code>`Q</code> shortcut to place quotes around the simple character
arrays in its right argument, <code>⍵</code>. This is useful when you want to distinguish between character output that might include numbers and <em>actual</em> numeric output.</p>
<pre><code>   ∆F '{`Q 1 2 &quot;three&quot; 4 5 (⍪1 &quot;2&quot;) (⍪&quot;cats&quot; &quot;dogs&quot;)}'
1 2  'three'  4 5     1    'cats'
                    '2'    'dogs'
</code></pre>
<p>And here’s an example with a simple, mixed vector.
First, we display an object without using the <strong>Quote</strong> shortcut.
Are you <strong><em>sure</em></strong> which elements are numbers and which are character scalars?</p>
<pre><code>   ∆F '{1 2 &quot;3&quot; 4 &quot;5&quot;}'
1 2 3 4 5
</code></pre>
<p>Now, we show it <strong><em>with</em></strong> the <strong>Quote</strong> shortcut.
Voila, quotes appear around the character digits, but not the actual numbers!</p>
<pre><code>   ∆F '{`Q 1 2 &quot;3&quot; 4 &quot;5&quot;}'
1 2 '3' 4 '5'
</code></pre>
<h3>The Wrap Shortcut <span style="color: red;">(Experimental)</span></h3>
<blockquote>
<p>Wrapping results in left and right decorators</p>
</blockquote>
<div class="content-with-bar">
<p>Here we make a quick mention of the <strong><em>experimental</em></strong> shortcut <strong>Wrap</strong>,¹ <code>`W</code>, which is used when you want a <strong><em>decorator</em></strong> string that is placed immediately to the left or right of <strong><em>each</em></strong> row of simple objects in the right argument, <code>⍵</code>.</p>
<ul>
<li>The decorators are in <code>⍺</code>, the left argument to <strong>Wrap</strong>: the left decorator, <code>0⊃2⍴⍺</code>, and the right decorator, <code>1⊃2⍴⍺</code>, with <code>⍺</code> defaulting to a single quote.</li>
<li>If you need to omit one or the other decorator, simply make it a null string <code>&quot;&quot;</code> or a <em>zilde</em> <code>⍬</code>.</li>
</ul>
<div style="margin-left: 20px;">
<table>
<thead>
<tr>
<th style="text-align:left">Note</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">¹ <strong>Wrap</strong> differs from the <strong>Quote</strong> shortcut <code>`Q</code>, which puts quotes <strong><em>only</em></strong> around the character arrays in <code>⍵</code>. For more, see <strong>Wrap</strong> (<code>`W</code>) <strong>Details</strong> <em>below</em>.</td>
</tr>
</tbody>
</table>
</div>
<p><strong>Here are two simple examples.</strong></p>
<p>In the first, we place <code>&quot;°C&quot;</code> after <strong>[a]</strong> each row of a table <code>⍪`⍵2</code>, or <strong>[b]</strong> after each simple vector in <code>,¨`⍵2</code>. We indicate that is no <em>left</em> decorator here
using <code>&quot;&quot;</code> or <code>⍬</code>, as here.</p>
<pre><code>⍝         ... [a] ...       .... [b] ....
    ∆F '{ `⍵1 `W ⍪`⍵2 } ...{ `⍵1 `W ,¨`⍵2 }' (⍬ '°C')(18 22 33)
18°C ... 18°C 22°C 33°C
22°C
33°C
</code></pre>
<p>In this next example, we place brackets around the lines of each simple array in a complex array.</p>
<pre><code>   ∆F '{&quot;[]&quot; `W (&quot;cats&quot;)(⍳2 2 1)(2 2⍴⍳4)(3 3⍴⎕A) }'
[cats] [0 0 0] [0 1] [ABC]
       [0 1 0] [2 3] [DEF]
                     [GHI]
       [1 0 0]
       [1 1 0]
</code></pre>
</div>
<p>Now, let’s move on to Self-documenting <strong>Code fields</strong>.</p>
<h3>Self-documenting <strong>Code fields</strong> (SDCFs)</h3>
<blockquote>
<p>Self-documenting Code fields are a useful debugging tool.</p>
</blockquote>
<p>What’s an SDCF? An SDCF¹ allows whatever source code is in a <strong>Code Field</strong> to be automatically displayed literally along with the result of evaluating that code.</p>
<div style="margin-left: 25px;">
<table>
<thead>
<tr>
<th style="text-align:left">Note</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">¹ Our SDCFs are based on Python’s single type of <strong><a href="https://docs.python.org/3/whatsnew/3.8.html#f-strings-support-for-self-documenting-expressions-and-debugging">self-documenting expressions</a></strong> in <em>f-strings</em>, but work somewhat differently. SDCFs are used <strong><em>only</em></strong> in <strong>Code fields</strong> (<em>duh</em>).</td>
</tr>
</tbody>
</table>
</div>
<p>You may automatically place the source for a <strong>Code field</strong>:</p>
<ul>
<li><code>→</code> to the left of the result of evaluating that code; or,</li>
<li><code>↓</code> centered above the result of evaluating that code.</li>
</ul>
<p>All you have to do is place</p>
<ul>
<li>the right arrow <code>→</code> for a <strong>horizontal</strong> SDCF, or</li>
<li>the down arrow <code>↓</code> for a <strong>vertical</strong> SDCF,</li>
</ul>
<p>as the <strong><em>last non-space</em></strong> in the <strong>Code field</strong>, before the <em>final</em> right brace.</p>
<p>Here’s an example of a horizontal SDCF, i.e. using <code>→</code>:</p>
<pre><code>   name←'John Smith' ◇ age← 34
   ∆F 'Current employee: {name→}, {age→}.'
Current employee: name→John Smith, age→34.
</code></pre>
<p>As a useful formatting feature, whatever spaces are just <strong><em>before</em></strong> or <strong><em>after</em></strong> the symbol <strong>→</strong> or <strong>↓</strong> are preserved <strong><em>verbatim</em></strong> in the output.</p>
<p>Here’s an example with such spaces: see how the spaces adjacent to the symbol <code>→</code> are mirrored in the output!</p>
<pre><code>   name←'John Smith' ◇ age← 34
   ∆F 'Current employee: {name → }, {age→ }.'
Current employee: name → John Smith, age→ 34.
</code></pre>
<p>Now, let’s look at an example of a vertical SDCF, i.e. using <code>↓</code>:</p>
<pre><code>   name←'John Smith' ◇ age← 34
   ∆F 'Current employee: {name↓} {age↓}.'
Current employee:  name↓     age↓.
                  John Smith  34
</code></pre>
<p>To make it easier to see, here’s the same result, but with a box around each field (using the <strong>Box</strong> option <code>0 0 1</code>).</p>
<pre><code>⍝  Box all fields
   0 0 1 ∆F 'Current employee: {name↓} {age↓}.'
┌──────────────────┬──────────┬─┬────┬─┐
│Current employee: │ name↓    │ │age↓│.│
│                  │John Smith│ │ 34 │ │
└──────────────────┴──────────┴─┴────┴─┘
</code></pre>
<h3>The Above Shortcut</h3>
<blockquote>
<p>A cut above the rest…</p>
</blockquote>
<p>Here’s a useful feature. Let’s use the shortcut <code>%</code> to display one expression centered above another; it’s called <strong>Above</strong> and can also be expressed as <code>`A</code>. Remember, <code>`⍵1</code> designates the <strong><em>first</em></strong> argument after the <em>f-string</em> itself, and <code>`⍵2</code> the <strong><em>second</em></strong>.</p>
<pre><code>   ∆F '{&quot;Employee&quot; % ⍪`⍵1} {&quot;Age&quot; % ⍪`⍵2}' ('John Smith' 'Mary Jones')(29 23)
Employee    Age
John Smith  29
Mary Jones  23
</code></pre>
<h3>Omega Shortcuts (Implicit)</h3>
<blockquote>
<p>The <em>next</em> best thing: the use of <code>`⍵</code> in <strong>Code field</strong> expressions…</p>
</blockquote>
<p>We said we’d present the use of omega shortcuts with implicit indices <code>`⍵</code> in <strong>Code fields</strong>.</p>
<p>The expression <code>`⍵</code> selects the <em>next</em> element of the right argument <code>⍵</code> to <strong>∆F</strong>, defaulting to <code>`⍵1</code> when first encountered, i.e. if there are <strong><em>no</em></strong> <code>`⍵</code> elements to the <strong><em>left</em></strong> in the entire <em>f-string</em>. If there is any such expression (e.g. <code>`⍵5</code>), then <code>`⍵</code> points to the element after that one (here, <code>`⍵6</code>). If the item to the left is <code>`⍵</code>, then we simply increment the index by <code>1</code> from that one.</p>
<p><strong>Let’s try an example.</strong> Here, we display arbitrary 2-dimensional expressions, one above the other.
<code>`⍵</code> refers to the <strong><em>next</em></strong> argument in sequence, left to right, starting with <code>`⍵1</code>, the first, i.e. <code>(⍵⊃⍨ 1+⎕IO)</code>. So, from left to right <code>`⍵</code> is <code>`⍵1</code>, <code>`⍵2</code>, and <code>`⍵3</code>. <em>Easy peasy.</em></p>
<pre><code>   ∆F '{(⍳2⍴`⍵) % (⍳2⍴`⍵) % (⍳2⍴`⍵)}' 1 2 3
    0 0
  0 0 0 1
  1 0 1 1
0 0 0 1 0 2
1 0 1 1 1 2
2 0 2 1 2 2
</code></pre>
<p>Let’s demonstrate here the equivalence of the <em>implicitly</em> and <em>explicitly</em> indexed <strong>Omega expressions</strong>!</p>
<pre><code>   a← ∆F '{(⍳2⍴`⍵) % (⍳2⍴`⍵) % (⍳2⍴`⍵)}' 1 2 3     ⍝ Implicit Omega expressions
   b← ∆F '{(⍳2⍴`⍵1) % (⍳2⍴`⍵2) % (⍳2⍴`⍵3)}' 1 2 3  ⍝ Explicit Omega expressions
   a ≡ b                                           ⍝ Are they the same?
1                                                  ⍝ Yes!
</code></pre>
<h3>Shortcuts With Individual Expressions</h3>
<p>Shortcuts often make sense with individual expressions, not just entire <strong>Code fields</strong>. They can be put in parentheses and manipulated like ordinary APL functions.
Here, we display one boxed value above the other.</p>
<pre><code>   ∆F '{(`B ⍳`⍵1) % `B ⍳`⍵2}' (2 2)(3 3)
  ┌───┬───┐
  │0 0│0 1│
  ├───┼───┤
  │1 0│1 1│
  └───┴───┘
┌───┬───┬───┐
│0 0│0 1│0 2│
├───┼───┼───┤
│1 0│1 1│1 2│
├───┼───┼───┤
│2 0│2 1│2 2│
└───┴───┴───┘
</code></pre>
<p>There are loads of other examples to discover.</p>
<h3>A Shortcut for Dates and Times</h3>
<p><strong>∆F</strong> supports a simple <strong>Date-Time</strong> shortcut <code>`T</code> built from <strong>1200⌶</strong> and <strong>⎕DT</strong>. It takes one or more Dyalog <code>⎕TS</code>-format timestamps as the right argument and a date-time specification as the (optional) left argument. Trailing elements of a timestamp may be omitted, if they are not referenced in the specification string.</p>
<p>Let’s look at the use of the <code>`T</code> (Date-Time) shortcut to show the
current time (now).</p>
<pre><code>   ∆F 'It is now {&quot;t:mm pp&quot; `T ⎕TS}.'
It is now 8:08 am.
</code></pre>
<p>Of course, the time displayed above will be the actual current time.</p>
<p>Here’s a fancier example (the power is in <code>1200⌶</code> and <code>⎕DT</code>).
(We’ve added the <em>truncated</em> timestamp <code>2025 01 01</code> right into the <em>f-string</em>.)</p>
<pre><code>   ∆F '{ &quot;D MMM YYYY ''was a'' Dddd.&quot;`T 2025 01 01}'
1 JAN 2025 was a Wednesday.
</code></pre>
<h3>A Shortcut for Dates and Times (Continued)</h3>
<p>If it bothers you to use <code>`T</code> for a date-only expression,
you can use <code>`D</code>, which means exactly the same thing.</p>
<pre><code>   ∆F '{ &quot;D MMM YYYY ''was a'' Dddd.&quot; `D 2025 01 02}'
2 JAN 2025 was a Thursday.
</code></pre>
<p>Here, we’ll pass the time stamp via a single omega
expression (hence it is in parentheses): <code>`⍵1</code>.</p>
<pre><code>   ∆F '{ &quot;D Mmm YYYY ''was a'' Dddd.&quot; `T `⍵1}' (2025 1 21)
21 Jan 2025 was a Tuesday.
</code></pre>
<p>We could also pass the time stamp via a sequence of omega
expressions: <code>`⍵ `⍵ `⍵</code>.
This is equivalent to the <em>slightly</em> verbose
expression: <code>`⍵1 `⍵2 `⍵3</code>.</p>
<pre><code>   ∆F '{ &quot;D Mmm YYYY ''was a'' Dddd.&quot; `T `⍵ `⍵ `⍵}' 2025 1 21
21 Jan 2025 was a Tuesday.
</code></pre>
<h3>Precomputed F-strings with the <em><strong>DFN</strong></em> Option</h3>
<p>The default returned from <strong>∆F</strong> is always (on success) a character matrix. That can be expressed via <code>∆F...</code> or <code>0 ∆F...</code>.¹ However, if the initial option (<strong><em>DFN</em></strong>) is <code>1</code>, i.e. the call is <code>1 ∆F...</code>, <strong>∆F</strong> returns a dfn that— when called later— will return the same expression.² This is most useful when you are likely to make repeated use an <em>f-string</em>, since the overhead for examining the <em>f-string</em> contents <em>once</em> would be amortized over all the calls.</p>
<div style="margin-left: 25px;">
<table>
<thead>
<tr>
<th style="text-align:left">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">¹ We discuss the options to <strong>∆F</strong> at the end of this documentation.</td>
</tr>
<tr>
<td style="text-align:left">² This assumes the resulting dfn is called with the same arguments in the same calling environment in the same state.</td>
</tr>
</tbody>
</table>
</div>
<p>Let’s explore getting the best performance for a heavily
used <strong>∆F</strong> string. Using the DFN option <code>(⍺[0]=1)</code>, we can generate a
dfn that will display the formatted output, without having to reanalyze
the <em>f-string</em> each time.
We will compare the performance of an <strong>∆F</strong>-string evaluated on the fly.</p>
<pre><code>   mx← ∆F '...'
</code></pre>
<p>versus one precomputed and returned as a dfn, using</p>
<pre><code>   dfn← 1 ∆F '...'
</code></pre>
<blockquote>
<p>First, let’s grab <code>cmpx</code>, so we can compare the performance…</p>
</blockquote>
<pre><code>   'cmpx' ⎕CY 'dfns'
</code></pre>
<p>Now, let’s proceed. Here’s the code:</p>
<pre><code>   C← 11 30 60

⍝ Here's our ∆F String t
   t←'The temperature is {&quot;I2&quot; $ C}°C or {&quot;F5.1&quot; $ F← 32+9×C÷5}°F'

⍝  Let's precompute a dfn T, given ∆F String t.
⍝  It has everything needed to generate the output,
⍝  except the external variables or additional arguments needed.
   T←1 ∆F t

⍝  Compare the performance of the two formats...
⍝  The precomputed version is about 17 times faster, in this run.
   cmpx '∆F t' 'T ⍬'
∆F t → 1.7E¯4 |   0% ⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕
 T ⍬ → 1.0E¯5 | -94% ⎕⎕
</code></pre>
<blockquote>
<p>Before we get to syntax and other information…</p>
</blockquote>
<p>Finally, we want to show you that the <em>dfn</em> returned from <code>1 ∆F...</code> can retrieve argument(s) passed on the right side of <strong>∆F</strong>. In fact, the <em>f-string</em> text <strong><em>originally</em></strong> passed when the <em>dfn</em> was generated is stored with the <em>dfn</em> itself as <code>`⍵0</code>, available for use.</p>
<p>So, as a variation on the example above, we will pass the centigrade value,
not as a variable, but as the first argument to <strong>∆F</strong> (i.e. <code>`⍵1`</code>).</p>
<pre><code>   t←'The temperature is {&quot;I2&quot; $ `⍵1}°C or {&quot;F5.1&quot; $ F← 32+9×`⍵1÷5}°F'
   T← 1 ∆F t

   ∆F t 35
The temperature is 35°C or 95.0°F

   T 35
The temperature is 35°C or 95.0°F

   cmpx '∆F t 35' 'T 35'
∆F t 35 → 1.7E¯4 |   0% ⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕⎕
   T 35 → 8.9E¯6 | -95% ⎕⎕
</code></pre>
<p>Below, we summarize key information you’ve already gleaned from the examples.</p>
<h2>∆F Syntax and Other Information</h2>
<h3>∆F Call Syntax Overview</h3>
<table>
<thead>
<tr>
<th style="text-align:left">Call Syntax <div style="width:200px"></div></th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>∆F</strong> <em>f-string</em></td>
<td style="text-align:left">Display an <em>f-string</em>; use the <em>default</em> options. The string may reference objects in the environment or in the string itself. Returns a character matrix.</td>
</tr>
<tr>
<td style="text-align:left"><strong>∆F</strong> <em>f-string</em> <em>arg1</em> [<em>arg2</em> …]</td>
<td style="text-align:left">Display an <em>f-string</em>; use the <em>default</em> options. Arguments presented <em>may</em> be referred to in the f-string. Returns a character matrix.</td>
</tr>
<tr>
<td style="text-align:left"><em>options</em> <strong>∆F</strong> <em>f-string</em> [<em>args</em>]</td>
<td style="text-align:left">Display an <em>f-string</em>; control the result with <em>options</em> specified (see below).</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">If the initial option (DFN) is <strong>0</strong> or omitted, returns a character matrix.</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">If the initial option (DFN) is <strong>1</strong>, returns a dfn that will display such a matrix (given an identical system state).</td>
</tr>
<tr>
<td style="text-align:left">‘help’ <strong>∆F</strong> ‘’</td>
<td style="text-align:left">Display help info and examples for <strong>∆F</strong>. The <em>f-string</em> is not examined.</td>
</tr>
<tr>
<td style="text-align:left"><strong>∆F</strong>⍨’help’</td>
<td style="text-align:left">Display help info and examples for <strong>∆F</strong>.</td>
</tr>
</tbody>
</table>
<h3>∆F Call Syntax Details</h3>
<table>
<thead>
<tr>
<th style="text-align:left">Element <div style="width:130px"></div></th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong><em>f-string</em></strong></td>
<td style="text-align:left">a format string, a single character vector.</td>
</tr>
<tr>
<td style="text-align:left"><strong><em>args</em></strong></td>
<td style="text-align:left">elements of ⍵ after the <em>f-string</em>, each of which can be accessed in the <em>f-string</em> via a <code>`⍵</code> shortcut (or an ordinary <code>⍵</code> expression).</td>
</tr>
<tr>
<td style="text-align:left"><strong><em>options</em></strong>: <em>mode</em></td>
<td style="text-align:left">[ <code>options←</code> [ <code>0</code> [ <code>0</code> [ <code>0</code> [ <code>0</code> ] ] ] ] | <code>'help'</code> ]</td>
</tr>
<tr>
<td style="text-align:left"> options[0]:<br> <em>dfn output mode</em></td>
<td style="text-align:left"><em><strong>DFN</strong></em>: If <code>1</code>, <strong>∆F</strong> returns a dfn, which (upon execution) produces the same output as the default mode.<BR><strong>Default</strong>: <strong>∆F</strong> returns a char. matrix.</td>
</tr>
<tr>
<td style="text-align:left"> options[1]:<br> <em>debug</em></td>
<td style="text-align:left"><em><strong>DBG</strong></em>: If <code>1</code>, displays the code that the <em>f-string</em> <strong><em>actually</em></strong> generates; if <strong><em>DFN</em></strong> is also <code>1</code>, this will include the embedded <em>f-string</em> source (accessed as <code>`⍵0</code>). Newline characters are rendered visibly as <code>␍</code>. After displaying the code, it is executed per any other options.</td>
</tr>
<tr>
<td style="text-align:left"> options[2]:<br> <em>box fields</em></td>
<td style="text-align:left"><em><strong>BOX</strong></em>: If <code>1</code>, each field (except a <strong>Null text</strong> field) is boxed separately.<BR><strong>Default</strong>: Nothing is boxed automatically. Any <strong>Code field</strong> expression may be explicitly boxed using the <strong>Box</strong> shortcut, <code>`B</code>.<br><strong>Note</strong>: <em><strong>BOX</strong></em> mode can be used both with <em><strong>DFN</strong></em> and default output mode.</td>
</tr>
<tr>
<td style="text-align:left"> options[3]:<br> <em>inline routines</em></td>
<td style="text-align:left"><em><strong>INLINE</strong></em>: If <code>1</code>, the code of each internal support function used is included in the result.<BR><strong>Default</strong>: Calls are made to library routines in <strong>⍙Fapl</strong>, created when <strong>∆Fapl</strong> and <strong>∆F</strong> was loaded.<br><strong>Note:</strong> <small>Setting <em><strong><em>INLINE</em></strong></em> to <code>1</code> is only useful if the <em><strong>DFN</strong></em> option is set. This option is experimental and may simply disappear one day.</small></td>
</tr>
<tr>
<td style="text-align:left">‘help’</td>
<td style="text-align:left">If <code>'help'</code> is specified, this amazing documentation is displayed.</td>
</tr>
<tr>
<td style="text-align:left"><strong><em>result</em></strong></td>
<td style="text-align:left">If <code>0=⊃options</code>, the result is always a character matrix.<br>If <code>1=⊃options</code>, the result is a dfn that, <em>when executed in the same environment with the same arguments</em>, generates that same character matrix. <br><strong>Note</strong>: If an error is signalled, no result is returned.</td>
</tr>
</tbody>
</table>
<h3>∆F Options</h3>
<ul>
<li>If the left argument <code>⍺</code> is omitted, the options default to <code>4⍴0</code>.</li>
<li>If the left argument <code>⍺</code> is a simple boolean vector or scalar, or an empty numeric vector <code>⍬</code>, the options are <code>4↑⍺</code>; subsequent elements are ignored;</li>
<li>If the left argument <code>⍺</code> starts with <code>'help'</code> (case ignored), this help information is displayed.</li>
<li>Otherwise, an error is signaled.</li>
</ul>
<h3>∆F Return Value</h3>
<ul>
<li>Unless the <strong>DFN</strong> option is selected, <strong>∆F</strong> always returns a character matrix of at least one row and zero columns, <code>1 0⍴0</code>, on success. If the ‘help’ option is specified, <strong>∆F</strong> displays this information, returning <code>1 0⍴0</code>.</li>
<li>If the <strong>DFN</strong> option is selected, <strong>∆F</strong> always returns a standard Dyalog dfn on success.</li>
<li>On failure of any sort, an informative APL error is signaled.</li>
</ul>
<h3>∆F F-string Building Blocks</h3>
<p>The first element in the right arg to ∆F is a character vector, an <em>f-string</em>,
which contains 3 types of fields: <strong>Text fields</strong>, <strong>Code fields</strong>, and <strong>Space fields</strong>.</p>
<ul>
<li>
<p><strong>Text fields</strong> consist of simple text, which may include any Unicode characters desired, including newlines. Newlines (actually, carriage returns, <code>⎕UCS 13</code>) are normally entered via the sequence <code>`◇</code>. Additionally, literal curly braces can be added via <code>`{</code> and <code>`}</code>, so there is no confusion with the simple curly braces used to begin and end <strong>Code fields</strong> and <strong>Space Fields</strong>. Finally, a simple backtick escape can be entered into a <strong>Text field</strong> by simply entering two such characters <code>``</code>.</p>
</li>
<li>
<p><strong>Code fields</strong> are run-time evaluated expressions enclosed within
simple, unescaped curly braces <code>{}</code>, i.e. those not preceded by a back-tick (see the previous paragraph). <strong>Code fields</strong> are essentially a Dyalog dfn with some extras. For escape sequences, see <strong>Escape Sequences</strong> below.</p>
</li>
<li>
<p><strong>Space fields</strong> are essentially a <em>degenerate</em> form of <strong>Code fields</strong>, consisting of a single pair of simple curly braces <code>{}</code> with zero or more spaces in between. A <strong>Space Field</strong> with zero spaces is a <strong>Null Space Field</strong>; while it may separate any other fields, its practical use is separating two adjacent <strong>Text Fields</strong>.</p>
</li>
</ul>
<p>The building blocks of an <em>f-string</em> are these defined “fields,” catenated left to right,
each of which will display as a logically separate 2-D (matrix) output space. While <strong>Code fields</strong> can return arrays of any number of dimensions mapped onto 2-D by APL <code>⎕FMT</code> rules, <strong>Text fields</strong> and <strong>Space fields</strong> are always simple rectangles (minimally 1 row and zero columns). Between fields, <strong>∆F</strong> adds no automatic spaces; that spacing is under user control.</p>
<h3>Escape Sequences For Text Fields and Quoted Strings</h3>
<p><strong>∆F</strong> <strong>Text fields</strong> and <strong>Quoted strings</strong> in <strong>Code fields</strong> may include
a small number of escape sequences, beginning with the backtick <code>`</code>.</p>
<table>
<thead>
<tr>
<th style="text-align:center"> Sequence </th>
<th style="text-align:center"> Literal </th>
<th style="text-align:center"> Meaning </th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">`◇</td>
<td style="text-align:center">(newline)</td>
<td style="text-align:center">  (⎕UCS 13) </td>
</tr>
<tr>
<td style="text-align:center">``</td>
<td style="text-align:center">`</td>
<td style="text-align:center">backtick</td>
</tr>
<tr>
<td style="text-align:center">`{</td>
<td style="text-align:center">{</td>
<td style="text-align:center">left brace</td>
</tr>
<tr>
<td style="text-align:center">`}</td>
<td style="text-align:center">}</td>
<td style="text-align:center">right brace</td>
</tr>
</tbody>
</table>
<p>Other instances of the backtick character in <strong>Text fields</strong> or <strong>Quoted strings</strong> in <strong>Code fields</strong> will be treated literally, <em>i.e.</em>
sometimes a backtick is just a backtick.</p>
<h3>Code Field Shortcuts</h3>
<p><strong>∆F</strong> <strong>Code fields</strong> may contain various shortcuts, intended to be concise and expressive tools for common tasks. <strong>Shortcuts</strong> are valid <strong>only</strong> outside <strong>Quoted strings</strong>. They include:</p>
<table>
<thead>
<tr>
<th style="text-align:left">Shortcut <div style="width:100px"></div></th>
<th style="text-align:left">Name <div style="width:150px"></div></th>
<th style="text-align:left">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">$, `F</td>
<td style="text-align:left">⎕FMT</td>
<td style="text-align:left"><code>[⍺] $ ⍵</code>. Short for <code>[⍺] ⎕FMT ⍵</code>. (See APL documentation).</td>
</tr>
<tr>
<td style="text-align:left">%, `A</td>
<td style="text-align:left">Above</td>
<td style="text-align:left"><code>[⍺] % ⍵</code>. Centers array <code>⍺</code> above array <code>⍵</code>. If omitted, <code>⍺←''</code>, i.e. a blank line.</td>
</tr>
<tr>
<td style="text-align:left">`B</td>
<td style="text-align:left">Box</td>
<td style="text-align:left"><code>`B ⍵</code>. Places <code>⍵</code> in a box. <code>⍵</code> is any array.</td>
</tr>
<tr>
<td style="text-align:left">`C</td>
<td style="text-align:left">Commas</td>
<td style="text-align:left"><code>`C ⍵</code>. Adds commas to <code>⍵</code> after every 3rd digit of the integer part of <code>⍵</code>, right-to-left. <code>⍵</code> is a vector of num strings or numbers.</td>
</tr>
<tr>
<td style="text-align:left">`Q</td>
<td style="text-align:left">Quote</td>
<td style="text-align:left"><code>[⍺]`Q ⍵</code>. Recursively scans <code>⍵</code>, putting char. vectors, scalars, and rows of higher-dimensional strings in APL quotes, leaving other elements as is. If omitted, <code>⍺←''''</code>.</td>
</tr>
<tr>
<td style="text-align:left">`T, `D</td>
<td style="text-align:left">Date-Time¹</td>
<td style="text-align:left"><code>[⍺]`T ⍵</code>. Displays timestamp(s) <code>⍵</code> according to date-time template <code>⍺</code>. <code>⍵</code> is one or more APL timestamps <code>⎕TS</code>. <code>⍺</code> is a date-time template in <code>1200⌶</code> format. If omitted, <code>⍺← 'YYYY-MM-DD hh:mm:ss'</code>.</td>
</tr>
<tr>
<td style="text-align:left">`W <span style="color: red;"><strong>EXPERIMENTAL!</strong></span></td>
<td style="text-align:left">Wrap</td>
<td style="text-align:left"><code>[⍺]`W ⍵</code>. Wraps the rows of simple arrays in ⍵ in decorators <code>0⊃2⍴⍺</code> (on the left) and <code>1⊃2⍴⍺</code> (on the right). If omitted, <code>⍺←''''</code>. <em>See details below.</em></td>
</tr>
<tr>
<td style="text-align:left">`⍵𝑑𝑑, ⍹𝑑𝑑</td>
<td style="text-align:left">Omega Shortcut (explicitly indexed)</td>
<td style="text-align:left">A shortcut of the form <code>`⍵𝑑𝑑</code> (or <code>⍹𝑑𝑑</code>), to access the <code>𝑑𝑑</code><strong>th</strong> element of <code>⍵</code>, i.e. <code>(⍵⊃⍨ 𝑑𝑑+⎕IO)</code>. <em>See details below.</em></td>
</tr>
<tr>
<td style="text-align:left">`⍵, ⍹</td>
<td style="text-align:left">Omega Shortcut (implicitly indexed)</td>
<td style="text-align:left">A shortcut of the form <code>`⍵</code> (or <code>⍹</code>), to access the <strong><em>next</em></strong> element of <code>⍵</code>. <em>See details below.</em></td>
</tr>
</tbody>
</table>
<hr>
<div style="margin-left: 20px;">
<table>
<thead>
<tr>
<th style="text-align:left">Note</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">¹ The syntax for the Date-Time specifications (left arg) can be found in the Dyalog documentation under <b>1200⌶</b>. For the curious, here’s the code actually used by the Date-Time shortcut: <br>    <code>{⍺←'YYYY-MM-DD hh:mm:ss' ◇ ∊⍣(1=≡⍵)⊢ ⍺(1200⌶)⊢ 1⎕DT ⊆⍵}</code>.</td>
</tr>
</tbody>
</table>
</div>
<hr>
<h3>Omega Shortcut Expressions: Details</h3>
<ol>
<li><strong>⍹</strong> is a synonym for <strong>`⍵</strong>. It is Unicode character <code>⎕UCS 9081</code>. Either expression is valid only in <strong>Code</strong> fields and outside <strong>Quoted strings</strong>.</li>
<li><strong>`⍵</strong> or <strong>⍹</strong> uses an “<em>omega index counter</em>” (<strong>OIC</strong>) which we’ll represent as <strong>Ω</strong>, common across all <strong>Code</strong> fields, which is initially set to zero, <code>Ω←0</code>. (Ω is just used for explication; don’t actually use this symbol)</li>
<li>All omega shortcut expressions in the <em>f-string</em> are evaluated left to right and are ⎕IO-independent.</li>
<li><strong>`⍵𝑑𝑑</strong> or <strong>⍹𝑑𝑑</strong> sets the <em>OIC</em> to 𝑑𝑑, <code>Ω←𝑑𝑑</code>, and returns the expression <code>(⍵⊃⍨Ω+⎕IO)</code>. Here <strong>𝑑𝑑</strong> must be a <em>non-negative integer</em> with at least 1 digit.</li>
<li>Bare <strong>`⍵</strong> or <strong>⍹</strong> (i.e. with no digits appended) increments the <em>OIC</em>, <code>Ω+←1</code>, <em>before</em> using it as the index in the expression <code>(⍵⊃⍨Ω+⎕IO)</code>.</li>
<li>You can only access the 0-th element of <strong>⍵</strong>, the <em>f-string</em> itself via an <em>explicitly indexed omega</em> <code>`⍵0</code> or <code>⍹0</code>. The <em>implicitly indexed</em> omega always increments its index <em>before</em> use, so the first index that can be used <strong><em>implicitly</em></strong> is <strong>1</strong>, i.e. <code>`⍵1</code> or <code>⍹1</code>.</li>
<li>If an element of the dfn’s right argument <strong>⍵</strong> is accessed at runtime via any means, shortcut or traditional, that element <strong><em>must</em></strong> exist.</li>
</ol>
<div class="content-with-bar">
<h3>Wrap Shortcut: Details <span style="color: red;"> <strong>(EXPERIMENTAL)</strong></span></h3>
<ol>
<li>Syntax: <code>[⍺←''''] `W ⍵</code>.</li>
<li>Let <code>L←0⊃2⍴⍺</code> and <code>R←1⊃2⍴⍺</code>.</li>
<li>Wrap each row <code>X′</code> of the simple arrays <code>X</code> in <code>⍵</code> (or the entire array <code>X</code> if a simple vector or scalar) in decorators <code>L</code> and <code>R</code>: <code>L,(⍕X′),R</code>.</li>
<li><code>⍵</code> is an array of any shape and depth.<code>L</code>and <code>R</code>are char. vectors or scalars or <code>⍬</code> (treated as <code>''</code>).</li>
<li>If there is one scalar or enclosed vector <code>⍺</code>, it is replicated <em>per (2) above</em>.</li>
<li>By default,<code>⍺← ''''</code>, i.e. APL quotes will wrap the array ⍵, row by row, whether character, numeric or otherwise.</li>
</ol>
</div>
<hr>
<h3>Table of Contents</h3>
<span style="">
<ul>
<li><a href="#f--formatted-string-literals">∆F — Formatted String Literals</a>
<ul>
<li><a href="#f-in-brief">∆F In Brief</a></li>
</ul>
</li>
<li><a href="#f-help-information">∆F <strong>Help</strong> Information</a></li>
<li><a href="#installing-f">Installing <strong>∆F</strong></a></li>
<li><a href="#f-examples">∆F EXAMPLES</a>
<ul>
<li><a href="#code-fields">Code Fields</a></li>
<li><a href="#text-fields-and-space-fields">Text Fields and Space Fields</a></li>
<li><a href="#null-space-fields">Null Space Fields</a></li>
<li><a href="#code-fields-continued">Code Fields (Continued)</a></li>
<li><a href="#the-box-shortcut">The Box Shortcut</a></li>
<li><a href="#box-mode">Box Mode</a></li>
<li><a href="#omega-shortcuts-explicit">Omega Shortcuts (Explicit)</a></li>
<li><a href="#referencing-the-f-string-itself">Referencing the F-string Itself</a></li>
<li><a href="#the-format-shortcut">The Format Shortcut</a></li>
<li><a href="#the-shortcut-for-numeric-commas">The Shortcut for Numeric Commas</a></li>
<li><a href="#the-quote-shortcut">The Quote Shortcut</a></li>
<li><a href="#the-wrap-shortcut-experimental">The Wrap Shortcut (Experimental)</a></li>
<li><a href="#self-documenting-code-fields-sdcfs">Self-documenting <strong>Code fields</strong> (SDCFs)</a></li>
<li><a href="#the-above-shortcut">The Above Shortcut</a></li>
<li><a href="#omega-shortcuts-implicit">Omega Shortcuts (Implicit)</a></li>
<li><a href="#shortcuts-with-individual-expressions">Shortcuts With Individual Expressions</a></li>
<li><a href="#a-shortcut-for-dates-and-times">A Shortcut for Dates and Times</a></li>
<li><a href="#a-shortcut-for-dates-and-times-continued">A Shortcut for Dates and Times (Continued)</a></li>
<li><a href="#precomputed-f-strings-with-the-dfn-option">Precomputed F-strings with the <em><strong>DFN</strong></em> Option</a></li>
</ul>
</li>
<li><a href="#f-syntax-and-other-information">∆F Syntax and Other Information</a>
<ul>
<li><a href="#f-call-syntax-overview">∆F Call Syntax Overview</a></li>
<li><a href="#f-call-syntax-details">∆F Call Syntax Details</a></li>
<li><a href="#f-options">∆F Options</a></li>
<li><a href="#f-return-value">∆F Return Value</a></li>
<li><a href="#f-f-string-building-blocks">∆F F-string Building Blocks</a></li>
<li><a href="#escape-sequences-for-text-fields-and-quoted-strings">Escape Sequences For Text Fields and Quoted Strings</a></li>
<li><a href="#code-field-shortcuts">Code Field Shortcuts</a></li>
<li><a href="#omega-shortcut-expressions-details">Omega Shortcut Expressions: Details</a></li>
<li><a href="#wrap-shortcut-details-experimental">Wrap Shortcut: Details  <strong>(EXPERIMENTAL)</strong></a></li>
<!-- TOC Link Suppressed -->
</ul>
</li>
</ul>
<hr>
</span>
<p>© 2025 Sam the Cat Foundation. [20250914T103109]</p>

</body>
</html>
